#!/bin/bash

echo "üîç –ù–∞—á–∏–Ω–∞–µ–º –≥–ª—É–±–æ–∫—É—é –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫—É —Å–µ—Ç–∏ Arcium..."

# 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ DNS –≤–Ω—É—Ç—Ä–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
echo -e "\n1. –¢–µ—Å—Ç DNS (–º–æ–∂–µ—Ç –ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ä–∞–∑—Ä–µ—à–∞—Ç—å –∏–º–µ–Ω–∞?):"
docker exec debug-node-0 nslookup google.com || echo "‚ùå –û—à–∏–±–∫–∞ DNS"

# 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã—Ö–æ–¥–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç (Ping)
echo -e "\n2. –¢–µ—Å—Ç –≤–Ω–µ—à–Ω–µ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è (Ping 8.8.8.8):"
docker exec debug-node-0 ping -c 2 8.8.8.8 || echo "‚ùå –ù–µ—Ç –≤—ã—Ö–æ–¥–∞ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç"

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤—è–∑–∏ —Å —Ö–æ—Å—Ç–æ–º —á–µ—Ä–µ–∑ gateway
echo -e "\n3. –¢–µ—Å—Ç host.docker.internal (–≤–∏–¥–∏—Ç –ª–∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä —Ö–æ—Å—Ç?):"
docker exec debug-node-0 ping -c 2 host.docker.internal || echo "‚ùå host.docker.internal –Ω–µ —Ä–µ–∑–æ–ª–≤–∏—Ç—Å—è"

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ Solana RPC –Ω–∞ —Ö–æ—Å—Ç–µ
echo -e "\n4. –¢–µ—Å—Ç –ø–æ—Ä—Ç–∞ Solana RPC (8899) –Ω–∞ —Ö–æ—Å—Ç–µ:"
# –ü—Ä–æ–±—É–µ–º –¥–æ—Å—Ç—É—á–∞—Ç—å—Å—è –¥–æ –ø–æ—Ä—Ç–∞ 8899 –Ω–∞ IP —à–ª—é–∑–∞
GW_IP=$(docker inspect -f '{{range .NetworkSettings.Networks}}{{.Gateway}}{{end}}' debug-node-0)
docker exec debug-node-0 nc -zv $GW_IP 8899 || echo "‚ùå –ü–æ—Ä—Ç 8899 –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω Firewall —Ö–æ—Å—Ç–∞"

# 5. –ü—Ä–æ–≤–µ—Ä–∫–∞ P2P —Å–≤—è–∑–∏ –º–µ–∂–¥—É –Ω–æ–¥–∞–º–∏ (–≤–Ω—É—Ç—Ä–µ–Ω–Ω—è—è —Å–µ—Ç—å)
echo -e "\n5. –¢–µ—Å—Ç P2P —Å–≤—è–∑–∏ –º–µ–∂–¥—É –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞–º–∏ (100 -> 101):"
docker exec debug-node-0 ping -c 2 172.20.0.101 || echo "‚ùå –ù–æ–¥—ã –Ω–µ –≤–∏–¥—è—Ç –¥—Ä—É–≥ –¥—Ä—É–≥–∞ –≤–Ω—É—Ç—Ä–∏ —Å–µ—Ç–∏ Docker"

# 6. –ü—Ä–æ–≤–µ—Ä–∫–∞ MTU (—á–∞—Å—Ç–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –≤ Ubuntu 24.04)
echo -e "\n6. –ü—Ä–æ–≤–µ—Ä–∫–∞ MTU (–ø–∞–∫–µ—Ç—ã –Ω–µ –¥–æ–ª–∂–Ω—ã –¥—Ä–æ–±–∏—Ç—å—Å—è):"
docker exec debug-node-0 ping -M do -s 1472 -c 2 8.8.8.8 || echo "‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ —Å MTU (–≤–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ —É–º–µ–Ω—å—à–∏—Ç—å –¥–æ 1400)"